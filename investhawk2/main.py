from multiprocessing import Process, freeze_support, Lock
from shared_data import init_shared, previous
from strategies import call, call_ten, call_fifteen
from websocket import run_websocket
from flask_app import run_flask

# Your original configuration
access_token = 'eyJ0eXAiOiJKV1QiLCJrZXlfaWQiOiJza192MS4wIiwiYWxnIjoiSFMyNTYifQ.eyJzdWIiOiI2VUJUN1ciLCJqdGkiOiI2N2UzOWQ0OTMzMDFjNDE0MGRjZWZiMWMiLCJpc011bHRpQ2xpZW50IjpmYWxzZSwiaWF0IjoxNzQyOTcwMTg1LCJpc3MiOiJ1ZGFwaS1nYXRld2F5LXNlcnZpY2UiLCJleHAiOjE3NDMwMjY0MDB9.U-iGX2gVCsHipyc54Fab9VpxjmjJiZg4tVTPAHbDg7w'  # Your access token
dict2 = {'NSE_EQ|INE585B01010': 'MARUTI', 'NSE_EQ|INE139A01034': 'NATIONALUM', 'NSE_EQ|INE947Q01028': 'LAURUSLABS', 'NSE_EQ|INE918I01026': 'BAJAJFINSV', 'NSE_EQ|INE758E01017': 'JIOFIN', 'NSE_EQ|INE522D01027': 'MANAPPURAM', 'NSE_EQ|INE089A01031': 'DRREDDY', 'NSE_EQ|INE00R701025': 'DALBHARAT', 'NSE_EQ|INE848E01016': 'NHPC', 'NSE_EQ|INE917I01010': 'BAJAJ-AUTO', 'NSE_EQ|INE070A01015': 'SHREECEM', 'NSE_EQ|INE982J01020': 'PAYTM', 'NSE_EQ|INE761H01022': 'PAGEIND', 'NSE_EQ|INE749A01030': 'JINDALSTEL', 'NSE_EQ|INE591G01017': 'COFORGE', 'NSE_EQ|INE494B01023': 'TVSMOTOR', 'NSE_EQ|INE160A01022': 'PNB', 'NSE_EQ|INE736A01011': 'CDSL', 'NSE_EQ|INE646L01027': 'INDIGO', 'NSE_EQ|INE010B01027': 'ZYDUSLIFE', 'NSE_EQ|INE102D01028': 'GODREJ', 'NSE_EQ|INE302A01020': 'EXIDEIND', 'NSE_EQ|INE134E01011': 'PFC', 'NSE_EQ|INE009A01021': 'INFY', 'NSE_EQ|INE376G01013': 'BIOCON', 'NSE_EQ|INE619A01035': 'PATANJALI', 'NSE_EQ|INE465A01025': 'BHARATFORG', 'NSE_EQ|INE463A01038': 'BERGEPAINT', 'NSE_EQ|INE397D01024': 'BHARTIARTL', 'NSE_EQ|INE192R01011': 'DMART', 'NSE_EQ|INE540L01014': 'ALKEM', 'NSE_EQ|INE775A01035': 'MOTHERSON', 'NSE_EQ|INE237A01028': 'KOTAKBANK', 'NSE_EQ|INE059A01026': 'CIPLA', 'NSE_EQ|INE732I01013': 'ANGELONE', 'NSE_EQ|INE361B01024': 'DIVISLAB', 'NSE_EQ|INE797F01020': 'JUBLFOOD', 'NSE_EQ|INE811K01011': 'PRESTIGE', 'NSE_EQ|INE180A01020': 'MFSL', 'NSE_EQ|INE949L01017': 'AUBANK', 'NSE_EQ|INE881D01027': 'OFSS', 'NSE_EQ|INE030A01027': 'HINDUNILVR', 'NSE_EQ|INE795G01014': 'HDFCLIFE', 'NSE_EQ|INE476A01022': 'CANBK', 'NSE_EQ|INE745G01035': 'MCX', 'NSE_EQ|INE531E01026': 'HINDCOPPER', 'NSE_EQ|INE823G01014': 'JKCEMENT', 'NSE_EQ|INE721A01047': 'SHRIRAMFIN', 'NSE_EQ|INE028A01039': 'BANKBARODA', 'NSE_EQ|INE670K01029': 'LODHA', 'NSE_EQ|INE280A01028': 'TITAN', 'NSE_EQ|INE158A01026': 'HEROMOTOCO', 'NSE_EQ|INE123W01016': 'SBILIFE', 'NSE_EQ|INE298A01020': 'CUMMINSIND', 'NSE_EQ|INE192A01025': 'TATACONSUM', 'NSE_EQ|INE769A01020': 'AARTIIND', 'NSE_EQ|INE398R01022': 'SYNGENE', 'NSE_EQ|INE155A01022': 'TATAMOTORS', 'NSE_EQ|INE674K01013': 'ABCAPITAL', 'NSE_EQ|INE094A01015': 'HINDPETRO', 'NSE_EQ|INE274J01014': 'OIL', 'NSE_EQ|INE528G01035': 'YESBANK', 'NSE_EQ|INE093I01010': 'OBEROIRLTY', 'NSE_EQ|INE726G01019': 'ICICIPRULI', 'NSE_EQ|INE012A01025': 'ACC', 'NSE_EQ|INE073K01018': 'SONACOMS', 'NSE_EQ|INE095A01012': 'INDUSINDBK', 'NSE_EQ|INE006I01046': 'ASTRAL', 'NSE_EQ|INE562A01011': 'INDIANB', 'NSE_EQ|INE195A01028': 'SUPREMEIND', 'NSE_EQ|INE142M01025': 'TATATECH', 'NSE_EQ|INE849A01020': 'TRENT', 'NSE_EQ|INE669C01036': 'TECHM', 'NSE_EQ|INE136B01020': 'CYIENT', 'NSE_EQ|INE216A01030': 'BRITANNIA', 'NSE_EQ|INE002S01010': 'MGL', 'NSE_EQ|INE111A01025': 'CONCOR', 'NSE_EQ|INE062A01020': 'SBIN', 'NSE_EQ|INE118H01025': 'BSE', 'NSE_EQ|INE364U01010': 'ADANIGREEN', 'NSE_EQ|INE238A01034': 'AXISBANK', 'NSE_EQ|INE081A01020': 'TATASTEEL', 'NSE_EQ|INE044A01036': 'SUNPHARMA', 'NSE_EQ|INE883A01011': 'MRF', 'NSE_EQ|INE075A01022': 'WIPRO', 'NSE_EQ|INE498L01015': 'LTF', 'NSE_EQ|INE935N01020': 'DIXON', 'NSE_EQ|INE002L01015': 'SJVN', 'NSE_EQ|INE038A01020': 'HINDALCO', 'NSE_EQ|INE484J01027': 'GODREJPROP', 'NSE_EQ|INE031A01017': 'HUDCO', 'NSE_EQ|INE242A01010': 'IOC', 'NSE_EQ|INE205A01025': 'VEDL', 'NSE_EQ|INE027H01010': 'MAXHEALTH', 'NSE_EQ|INE692A01016': 'UNIONBANK', 'NSE_EQ|INE04I401011': 'KPITTECH', 'NSE_EQ|INE101D01020': 'GRANULES', 'NSE_EQ|INE010V01017': 'LTTS', 'NSE_EQ|INE263A01024': 'BEL', 'NSE_EQ|INE020B01018': 'RECLTD', 'NSE_EQ|INE685A01028': 'TORNTPHARM', 'NSE_EQ|INE647A01010': 'SRF', 'NSE_EQ|INE121A08PJ0': 'CHOLAFIN', 'NSE_EQ|INE860A01027': 'HCLTECH', 'NSE_EQ|INE974X01010': 'TIINDIA', 'NSE_EQ|INE854D01024': 'UNITDSPR', 'NSE_EQ|INE220G01021': 'JSL', 'NSE_EQ|INE742F01042': 'ADANIPORTS', 'NSE_EQ|INE226A01021': 'VOLTAS', 'NSE_EQ|INE171A01029': 'FEDERALBNK', 'NSE_EQ|INE976G01028': 'RBLBANK', 'NSE_EQ|INE047A01021': 'GRASIM', 'NSE_EQ|INE326A01037': 'LUPIN', 'NSE_EQ|INE262H01021': 'PERSISTENT', 'NSE_EQ|INE584A01023': 'NMDC', 'NSE_EQ|INE084A01016': 'BANKINDIA', 'NSE_EQ|INE085A01013': 'CHAMBLFERT', 'NSE_EQ|INE878B01027': 'KEI', 'NSE_EQ|INE836A01035': 'BSOFT', 'NSE_EQ|INE548A01028': 'HFCL', 'NSE_EQ|INE414G01012': 'MUTHOOTFIN', 'NSE_EQ|INE018E01016': 'SBICARD', 'NSE_EQ|INE669E01016': 'IDEA', 'NSE_EQ|INE776C01039': 'GMRAIRPORT', 'NSE_EQ|INE211B01039': 'PHOENIXLTD', 'NSE_EQ|INE417T01026': 'POLICYBZR', 'NSE_EQ|INE813H01021': 'TORNTPOWER', 'NSE_EQ|INE868B01028': 'NCC', 'NSE_EQ|INE213A01029': 'ONGC', 'NSE_EQ|INE335Y01020': 'IRCTC', 'NSE_EQ|INE931S01010': 'ADANIENSOL', 'NSE_EQ|INE821I01022': 'IRB', 'NSE_EQ|INE053F01010': 'IRFC', 'NSE_EQ|INE323A01026': 'BOSCHLTD', 'NSE_EQ|INE127D01025': 'HDFCAMC', 'NSE_EQ|INE021A01026': 'ASIANPAINT', 'NSE_EQ|INE356A01018': 'MPHASIS', 'NSE_EQ|INE733E01010': 'NTPC', 'NSE_EQ|INE214T01019': 'LTIM', 'NSE_EQ|INE176B01034': 'HAVELLS', 'NSE_EQ|INE022Q01020': 'IEX', 'NSE_EQ|INE545U01014': 'BANDHANBNK', 'NSE_EQ|INE511C01022': 'POONAWALLA', 'NSE_EQ|INE115A01026': 'LICHSGFIN', 'NSE_EQ|INE596I01012': 'CAMS', 'NSE_EQ|INE702C01027': 'APLAPOLLO', 'NSE_EQ|INE343H01029': 'SOLARINDS', 'NSE_EQ|INE388Y01029': 'NYKAA', 'NSE_EQ|INE117A01022': 'ABB', 'NSE_EQ|INE530B01024': 'IIFL', 'NSE_EQ|INE239A01024': 'NESTLEIND', 'NSE_EQ|INE758T01015': 'ZOMATO', 'NSE_EQ|INE154A01025': 'ITC', 'NSE_EQ|INE455K01017': 'POLYCAB', 'NSE_EQ|INE406A01037': 'AUROPHARMA', 'NSE_EQ|INE101A01026': 'M&M', 'NSE_EQ|INE437A01024': 'APOLLOHOSP', 'NSE_EQ|INE208A01029': 'ASHOKLEY', 'NSE_EQ|INE303R01014': 'KALYANKJIL', 'NSE_EQ|INE245A01021': 'TATAPOWER', 'NSE_EQ|INE288B01029': 'DEEPAKNTR', 'NSE_EQ|INE148O01028': 'DELHIVERY', 'NSE_EQ|INE331A01037': 'RAMCOCEM', 'NSE_EQ|INE053A01029': 'INDHOTEL', 'NSE_EQ|INE090A01021': 'ICICIBANK', 'NSE_EQ|INE628A01036': 'UPL', 'NSE_EQ|INE196A01026': 'MARICO', 'NSE_EQ|INE787D01026': 'BALKRISIND', 'NSE_EQ|INE018A01030': 'LT', 'NSE_EQ|INE121J01017': 'INDUSTOWER', 'NSE_EQ|INE140A01024': 'PEL', 'NSE_EQ|INE399L01023': 'ATGL', 'NSE_EQ|INE092T01019': 'IDFCFIRSTB', 'NSE_EQ|INE347G01014': 'PETRONET', 'NSE_EQ|INE067A01029': 'CGPOWER', 'NSE_EQ|INE438A01022': 'APOLLOTYRE', 'NSE_EQ|INE615H01020': 'TITAGARH', 'NSE_EQ|INE423A01024': 'ADANIENT', 'NSE_EQ|INE121E01018': 'JSWENERGY', 'NSE_EQ|INE019A01038': 'JSWSTEEL', 'NSE_EQ|INE151A01013': 'TATACOMM', 'NSE_EQ|INE259A01022': 'COLPAL', 'NSE_EQ|INE522F01014': 'COALINDIA', 'NSE_EQ|INE095N01031': 'NBCC', 'NSE_EQ|INE296A01024': 'BAJFINANCE', 'NSE_EQ|INE765G01017': 'ICICIGI', 'NSE_EQ|INE066F01020': 'HAL', 'NSE_EQ|INE257A01026': 'BHEL', 'NSE_EQ|INE002A01018': 'RELIANCE', 'NSE_EQ|INE203G01027': 'IGL', 'NSE_EQ|INE467B01029': 'TCS', 'NSE_EQ|INE774D08MG3': 'M&MFIN', 'NSE_EQ|INE647O01011': 'ABFRL', 'NSE_EQ|INE079A01024': 'AMBUJACEM', 'NSE_EQ|INE129A01019': 'GAIL', 'NSE_EQ|INE0J1Y01017': 'LICI', 'NSE_EQ|INE481G01011': 'ULTRACEMCO', 'NSE_EQ|INE299U01018': 'CROMPTON', 'NSE_EQ|INE040A01034': 'HDFCBANK', 'NSE_EQ|INE114A01011': 'SAIL', 'NSE_EQ|INE486A01021': 'CESC', 'NSE_EQ|INE935A01035': 'GLENMARK', 'NSE_EQ|INE603J01030': 'PIIND', 'NSE_EQ|INE003A01024': 'SIEMENS', 'NSE_EQ|INE202E01016': 'IREDA', 'NSE_EQ|INE066A01021': 'EICHERMOT', 'NSE_EQ|INE029A01011': 'BPCL', 'NSE_EQ|INE670A01012': 'TATAELXSI', 'NSE_EQ|INE663F01024': 'NAUKRI', 'NSE_EQ|INE752E01010': 'POWERGRID', 'NSE_EQ|INE092A01019': 'TATACHEM', 'NSE_EQ|INE271C01023': 'DLF', 'NSE_EQ|INE318A01026': 'PIDILITIND', 'NSE_EQ|INE200M01039': 'VBL', 'NSE_EQ|INE016A01026': 'DABUR', 'NSE_EQ|INE042A01014': 'ESCORTS'}
allstock = ['MARUTI', 'NATIONALUM', 'LAURUSLABS', 'BAJAJFINSV', 'JIOFIN', 'MANAPPURAM', 'DRREDDY', 'DALBHARAT', 'NHPC', 'BAJAJ-AUTO', 'SHREECEM', 'PAYTM', 'PAGEIND', 'JINDALSTEL', 'COFORGE', 'TVSMOTOR', 'PNB', 'CDSL', 'INDIGO', 'ZYDUSLIFE', 'GODREJ', 'EXIDEIND', 'PFC', 'INFY', 'BIOCON', 'PATANJALI', 'BHARATFORG', 'BERGEPAINT', 'BHARTIARTL', 'DMART', 'ALKEM', 'MOTHERSON', 'KOTAKBANK', 'CIPLA', 'ANGELONE', 'DIVISLAB', 'JUBLFOOD', 'PRESTIGE', 'MFSL', 'AUBANK', 'OFSS', 'HINDUNILVR', 'HDFCLIFE', 'CANBK', 'MCX', 'HINDCOPPER', 'JKCEMENT', 'SHRIRAMFIN', 'BANKBARODA', 'LODHA', 'TITAN', 'HEROMOTOCO', 'SBILIFE', 'CUMMINSIND', 'TATACONSUM', 'AARTIIND', 'SYNGENE', 'TATAMOTORS', 'ABCAPITAL', 'HINDPETRO', 'OIL', 'YESBANK', 'OBEROIRLTY', 'ICICIPRULI', 'ACC', 'SONACOMS', 'INDUSINDBK', 'ASTRAL', 'INDIANB', 'SUPREMEIND', 'TATATECH', 'TRENT', 'TECHM', 'CYIENT', 'BRITANNIA', 'MGL', 'CONCOR', 'SBIN', 'BSE', 'ADANIGREEN', 'AXISBANK', 'TATASTEEL', 'SUNPHARMA', 'MRF', 'WIPRO', 'LTF', 'DIXON', 'SJVN', 'HINDALCO', 'GODREJPROP', 'HUDCO', 'IOC', 'VEDL', 'MAXHEALTH', 'UNIONBANK', 'KPITTECH', 'GRANULES', 'LTTS', 'BEL', 'RECLTD', 'TORNTPHARM', 'SRF', 'CHOLAFIN', 'HCLTECH', 'TIINDIA', 'UNITDSPR', 'JSL', 'ADANIPORTS', 'VOLTAS', 'FEDERALBNK', 'RBLBANK', 'GRASIM', 'LUPIN', 'PERSISTENT', 'NMDC', 'BANKINDIA', 'CHAMBLFERT', 'KEI', 'BSOFT', 'HFCL', 'MUTHOOTFIN', 'SBICARD', 'IDEA', 'GMRAIRPORT', 'PHOENIXLTD', 'POLICYBZR', 'TORNTPOWER', 'NCC', 'ONGC', 'IRCTC', 'ADANIENSOL', 'IRB', 'IRFC', 'BOSCHLTD', 'HDFCAMC', 'ASIANPAINT', 'MPHASIS', 'NTPC', 'LTIM', 'HAVELLS', 'IEX', 'BANDHANBNK', 'POONAWALLA', 'LICHSGFIN', 'CAMS', 'APLAPOLLO', 'SOLARINDS', 'NYKAA', 'ABB', 'IIFL', 'NESTLEIND', 'ZOMATO', 'ITC', 'POLYCAB', 'AUROPHARMA', 'M&M', 'APOLLOHOSP', 'ASHOKLEY', 'KALYANKJIL', 'TATAPOWER', 'DEEPAKNTR', 'DELHIVERY', 'RAMCOCEM', 'INDHOTEL', 'ICICIBANK', 'UPL', 'MARICO', 'BALKRISIND', 'LT', 'INDUSTOWER', 'PEL', 'ATGL', 'IDFCFIRSTB', 'PETRONET', 'CGPOWER', 'APOLLOTYRE', 'TITAGARH', 'ADANIENT', 'JSWENERGY', 'JSWSTEEL', 'TATACOMM', 'COLPAL', 'COALINDIA', 'NBCC', 'BAJFINANCE', 'ICICIGI', 'HAL', 'BHEL', 'RELIANCE', 'IGL', 'TCS', 'M&MFIN', 'ABFRL', 'AMBUJACEM', 'GAIL', 'LICI', 'ULTRACEMCO', 'CROMPTON', 'HDFCBANK', 'SAIL', 'CESC', 'GLENMARK', 'PIIND', 'SIEMENS', 'IREDA', 'EICHERMOT', 'BPCL', 'TATAELXSI', 'NAUKRI', 'POWERGRID', 'TATACHEM', 'DLF', 'PIDILITIND', 'VBL', 'DABUR', 'ESCORTS']
allstockkeys =['NSE_EQ|INE585B01010','NSE_EQ|INE139A01034','NSE_EQ|INE947Q01028', 'NSE_EQ|INE918I01026', 'NSE_EQ|INE758E01017', 'NSE_EQ|INE522D01027', 'NSE_EQ|INE089A01031', 'NSE_EQ|INE00R701025', 'NSE_EQ|INE848E01016', 'NSE_EQ|INE917I01010', 'NSE_EQ|INE070A01015', 'NSE_EQ|INE982J01020', 'NSE_EQ|INE761H01022', 'NSE_EQ|INE749A01030', 'NSE_EQ|INE591G01017', 'NSE_EQ|INE494B01023', 'NSE_EQ|INE160A01022', 'NSE_EQ|INE736A01011', 'NSE_EQ|INE646L01027', 'NSE_EQ|INE010B01027', 'NSE_EQ|INE102D01028', 'NSE_EQ|INE302A01020', 'NSE_EQ|INE134E01011', 'NSE_EQ|INE009A01021', 'NSE_EQ|INE376G01013', 'NSE_EQ|INE619A01035', 'NSE_EQ|INE465A01025', 'NSE_EQ|INE463A01038', 'NSE_EQ|INE397D01024', 'NSE_EQ|INE192R01011', 'NSE_EQ|INE540L01014', 'NSE_EQ|INE775A01035', 'NSE_EQ|INE237A01028', 'NSE_EQ|INE059A01026', 'NSE_EQ|INE732I01013', 'NSE_EQ|INE361B01024', 'NSE_EQ|INE797F01020', 'NSE_EQ|INE811K01011', 'NSE_EQ|INE180A01020', 'NSE_EQ|INE949L01017', 'NSE_EQ|INE881D01027', 'NSE_EQ|INE030A01027', 'NSE_EQ|INE795G01014', 'NSE_EQ|INE476A01022', 'NSE_EQ|INE745G01035', 'NSE_EQ|INE531E01026', 'NSE_EQ|INE823G01014', 'NSE_EQ|INE721A01047', 'NSE_EQ|INE028A01039', 'NSE_EQ|INE670K01029', 'NSE_EQ|INE280A01028', 'NSE_EQ|INE158A01026', 'NSE_EQ|INE123W01016', 'NSE_EQ|INE298A01020', 'NSE_EQ|INE192A01025', 'NSE_EQ|INE769A01020', 'NSE_EQ|INE398R01022', 'NSE_EQ|INE155A01022', 'NSE_EQ|INE674K01013', 'NSE_EQ|INE094A01015', 'NSE_EQ|INE274J01014', 'NSE_EQ|INE528G01035', 'NSE_EQ|INE093I01010', 'NSE_EQ|INE726G01019', 'NSE_EQ|INE012A01025', 'NSE_EQ|INE073K01018', 'NSE_EQ|INE095A01012', 'NSE_EQ|INE006I01046', 'NSE_EQ|INE562A01011', 'NSE_EQ|INE195A01028', 'NSE_EQ|INE142M01025', 'NSE_EQ|INE849A01020', 'NSE_EQ|INE669C01036', 'NSE_EQ|INE136B01020', 'NSE_EQ|INE216A01030', 'NSE_EQ|INE002S01010', 'NSE_EQ|INE111A01025', 'NSE_EQ|INE062A01020', 'NSE_EQ|INE118H01025', 'NSE_EQ|INE364U01010', 'NSE_EQ|INE238A01034', 'NSE_EQ|INE081A01020', 'NSE_EQ|INE044A01036', 'NSE_EQ|INE883A01011', 'NSE_EQ|INE075A01022', 'NSE_EQ|INE498L01015', 'NSE_EQ|INE935N01020', 'NSE_EQ|INE002L01015', 'NSE_EQ|INE038A01020', 'NSE_EQ|INE484J01027', 'NSE_EQ|INE031A01017', 'NSE_EQ|INE242A01010', 'NSE_EQ|INE205A01025', 'NSE_EQ|INE027H01010', 'NSE_EQ|INE692A01016', 'NSE_EQ|INE04I401011', 'NSE_EQ|INE101D01020', 'NSE_EQ|INE010V01017', 'NSE_EQ|INE263A01024', 'NSE_EQ|INE020B01018', 'NSE_EQ|INE685A01028', 'NSE_EQ|INE647A01010', 'NSE_EQ|INE121A08PJ0', 'NSE_EQ|INE860A01027', 'NSE_EQ|INE974X01010', 'NSE_EQ|INE854D01024', 'NSE_EQ|INE220G01021', 'NSE_EQ|INE742F01042', 'NSE_EQ|INE226A01021', 'NSE_EQ|INE171A01029', 'NSE_EQ|INE976G01028', 'NSE_EQ|INE047A01021', 'NSE_EQ|INE326A01037', 'NSE_EQ|INE262H01021', 'NSE_EQ|INE584A01023', 'NSE_EQ|INE084A01016', 'NSE_EQ|INE085A01013', 'NSE_EQ|INE878B01027', 'NSE_EQ|INE836A01035', 'NSE_EQ|INE548A01028', 'NSE_EQ|INE414G01012', 'NSE_EQ|INE018E01016', 'NSE_EQ|INE669E01016', 'NSE_EQ|INE776C01039', 'NSE_EQ|INE211B01039', 'NSE_EQ|INE417T01026', 'NSE_EQ|INE813H01021', 'NSE_EQ|INE868B01028', 'NSE_EQ|INE213A01029', 'NSE_EQ|INE335Y01020', 'NSE_EQ|INE931S01010', 'NSE_EQ|INE821I01022', 'NSE_EQ|INE053F01010', 'NSE_EQ|INE323A01026', 'NSE_EQ|INE127D01025', 'NSE_EQ|INE021A01026', 'NSE_EQ|INE356A01018', 'NSE_EQ|INE733E01010', 'NSE_EQ|INE214T01019', 'NSE_EQ|INE176B01034', 'NSE_EQ|INE022Q01020', 'NSE_EQ|INE545U01014', 'NSE_EQ|INE511C01022', 'NSE_EQ|INE115A01026', 'NSE_EQ|INE596I01012', 'NSE_EQ|INE702C01027', 'NSE_EQ|INE343H01029', 'NSE_EQ|INE388Y01029', 'NSE_EQ|INE117A01022', 'NSE_EQ|INE530B01024', 'NSE_EQ|INE239A01024', 'NSE_EQ|INE758T01015', 'NSE_EQ|INE154A01025', 'NSE_EQ|INE455K01017', 'NSE_EQ|INE406A01037', 'NSE_EQ|INE101A01026', 'NSE_EQ|INE437A01024', 'NSE_EQ|INE208A01029', 'NSE_EQ|INE303R01014', 'NSE_EQ|INE245A01021', 'NSE_EQ|INE288B01029', 'NSE_EQ|INE148O01028', 'NSE_EQ|INE331A01037', 'NSE_EQ|INE053A01029', 'NSE_EQ|INE090A01021', 'NSE_EQ|INE628A01036', 'NSE_EQ|INE196A01026', 'NSE_EQ|INE787D01026', 'NSE_EQ|INE018A01030', 'NSE_EQ|INE121J01017', 'NSE_EQ|INE140A01024', 'NSE_EQ|INE399L01023', 'NSE_EQ|INE092T01019', 'NSE_EQ|INE347G01014', 'NSE_EQ|INE067A01029', 'NSE_EQ|INE438A01022', 'NSE_EQ|INE615H01020', 'NSE_EQ|INE423A01024', 'NSE_EQ|INE121E01018', 'NSE_EQ|INE019A01038', 'NSE_EQ|INE151A01013', 'NSE_EQ|INE259A01022', 'NSE_EQ|INE522F01014', 'NSE_EQ|INE095N01031', 'NSE_EQ|INE296A01024', 'NSE_EQ|INE765G01017', 'NSE_EQ|INE066F01020', 'NSE_EQ|INE257A01026', 'NSE_EQ|INE002A01018', 'NSE_EQ|INE203G01027', 'NSE_EQ|INE467B01029', 'NSE_EQ|INE774D08MG3', 'NSE_EQ|INE647O01011', 'NSE_EQ|INE079A01024', 'NSE_EQ|INE129A01019', 'NSE_EQ|INE0J1Y01017', 'NSE_EQ|INE481G01011', 'NSE_EQ|INE299U01018', 'NSE_EQ|INE040A01034', 'NSE_EQ|INE114A01011', 'NSE_EQ|INE486A01021', 'NSE_EQ|INE935A01035', 'NSE_EQ|INE603J01030', 'NSE_EQ|INE003A01024', 'NSE_EQ|INE202E01016', 'NSE_EQ|INE066A01021', 'NSE_EQ|INE029A01011', 'NSE_EQ|INE670A01012', 'NSE_EQ|INE663F01024', 'NSE_EQ|INE752E01010', 'NSE_EQ|INE092A01019', 'NSE_EQ|INE271C01023', 'NSE_EQ|INE318A01026', 'NSE_EQ|INE200M01039', 'NSE_EQ|INE016A01026',
                                   'NSE_EQ|INE042A01014']


def main():
    manager = Manager()
    shared = manager.Namespace()
    shared.allstock = manager.list(['STOCK1', 'STOCK2'])  # Initial stocks
    shared.tenstocks = manager.list()
    shared.fifteenstocks = manager.list()
    shared.real_time_data = manager.dict()
    shared.previous_close_data = manager.dict({
        'STOCK1': {'ten': 100, 'tensell': 90, ...},  # Your precomputed values
        'STOCK2': {'ten': 200, 'tensell': 180, ...},
    })

    lock = Lock()
    stop_flags = [Event() for _ in range(3)]

    processes = [
        Process(target=call, args=(shared, lock, stop_flags[0])),
        Process(target=call_ten, args=(shared, lock, stop_flags[1])),
        Process(target=call_fifteen, args=(shared, lock, stop_flags[2])),
        Process(target=run_websocket, args=(shared, 'ACCESS_TOKEN', {'NSE:STOCK1': 'STOCK1', ...}, lock))
    ]

    for p in processes:
        p.start()

    try:
        while True:
            time.sleep(1)
    except KeyboardInterrupt:
        for flag in stop_flags:
            flag.set()
        for p in processes:
            p.join()

if __name__ == "__main__":
    main()